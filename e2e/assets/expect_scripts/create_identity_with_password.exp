#!/usr/bin/expect -f
#
# This Expect script was generated by autoexpect on Wed Mar  9 13:51:53 2022
# Expect and autoexpect were both written by Don Libes, NIST.

match_max 100000

spawn dfx identity new alice
expect {
	"Please enter a passphrase for your identity: " {
		send -- "testpassword\r"
	}
	timeout {
		puts stderr "Not asked for a password when creating new identity!"
		exit 1
	}
}
expect eof

spawn dfx identity use alice
expect eof

spawn dfx identity get-principal
expect {
	"Please enter a passphrase for your identity: " {
		send -- "testpassword\r"
	}
	timeout {
		puts stderr "Not asked for a password when decrypting identity!"
		exit 1
	}
}
expect "Decryption complete."
expect eof
